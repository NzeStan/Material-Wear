<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Two-Factor Authentication{% endblock %} | Material Wear</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

    <style>
        /* ── Reset ─────────────────────────────────────────────────────────── */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* ── Page background ────────────────────────────────────────────────── */
        body {
            font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #064E3B 0%, #065F46 55%, #047857 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            color: #1F2937;
            font-size: 15px;
            line-height: 1.6;
        }

        /* ── Card ───────────────────────────────────────────────────────────── */
        .auth-card {
            background: #ffffff;
            width: 100%;
            max-width: 580px;           /* wider than before */
            border-radius: 18px;
            box-shadow: 0 24px 70px rgba(0, 0, 0, 0.28);
            overflow: hidden;
        }

        /* ── Brand header ───────────────────────────────────────────────────── */
        .card-header {
            background: #064E3B;
            padding: 36px 44px 30px;
            text-align: center;
        }

        .brand-wrap {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 12px;
        }

        .brand-icon {
            width: 36px;
            height: 36px;
            background: #F59E0B;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .brand-icon svg {
            width: 22px;
            height: 22px;
            fill: #064E3B;
        }

        .brand-name {
            font-size: 24px;
            font-weight: 700;
            color: #ffffff;
            letter-spacing: 0.3px;
        }

        .brand-name em {
            color: #F59E0B;
            font-style: normal;
        }

        .card-header h1 {
            color: #ffffff;
            font-size: 18px;
            font-weight: 600;
            margin-top: 4px;
            letter-spacing: 0.2px;
        }

        .card-header .subtext {
            color: #6EE7B7;
            font-size: 13px;
            margin-top: 5px;
        }

        /* ── Wizard step bar ────────────────────────────────────────────────── */
        .wizard-steps {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0;
            background: #F0FDF4;
            border-bottom: 2px solid #D1FAE5;
            padding: 16px 44px;
        }

        .step-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            font-weight: 500;
            color: #9CA3AF;
        }

        .step-item.active { color: #064E3B; }
        .step-item.done   { color: #F59E0B; }

        .step-dot {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #E5E7EB;
            color: #9CA3AF;
            font-size: 12px;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: background 0.2s, color 0.2s;
        }

        .step-item.active .step-dot {
            background: #064E3B;
            color: #ffffff;
        }

        .step-item.done .step-dot {
            background: #F59E0B;
            color: #ffffff;
        }

        .step-connector {
            width: 36px;
            height: 2px;
            background: #E5E7EB;
            margin: 0 4px;
        }

        /* ── Card body ──────────────────────────────────────────────────────── */
        .card-body {
            padding: 36px 44px;
        }

        /* ── Flash messages ─────────────────────────────────────────────────── */
        .messages {
            margin-bottom: 24px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .message {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 13px 16px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 500;
            border-width: 1px;
            border-style: solid;
        }

        .message.error   { background: #FEF2F2; border-color: #FECACA; color: #B91C1C; }
        .message.success { background: #F0FDF4; border-color: #BBF7D0; color: #15803D; }
        .message.warning { background: #FFFBEB; border-color: #FCD34D; color: #92400E; }
        .message.info    { background: #EFF6FF; border-color: #BFDBFE; color: #1D4ED8; }

        .message-icon {
            font-size: 16px;
            flex-shrink: 0;
            line-height: 1.4;
        }

        /* ── QR code section ────────────────────────────────────────────────── */
        .qr-wrapper {
            text-align: center;
            margin-bottom: 28px;
            padding: 24px;
            background: #F0FDF4;
            border: 2px solid #D1FAE5;
            border-radius: 14px;
        }

        .qr-wrapper img {
            max-width: 200px;
            width: 100%;
            border-radius: 8px;
            display: block;
            margin: 0 auto;
        }

        .qr-wrapper p {
            margin-top: 12px;
            font-size: 13px;
            color: #6B7280;
        }

        /* ── Instruction / description block ────────────────────────────────── */
        .content-description {
            background: #FFFBEB;
            border: 1px solid #F59E0B;
            border-radius: 10px;
            padding: 16px 18px;
            font-size: 14px;
            color: #374151;
            margin-bottom: 24px;
            line-height: 1.65;
        }

        .content-description strong {
            color: #064E3B;
        }

        /* ── Form styles ────────────────────────────────────────────────────── */

        /* Hide the blank wizard management submit button */
        input[type="submit"][value=""],
        input[type="submit"]:not([value]),
        button[type="submit"]:empty {
            display: none !important;
        }

        /* Fieldset / label */
        label,
        .tf-form label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 7px;
        }

        /* All text-style inputs */
        input[type="text"],
        input[type="password"],
        input[type="number"],
        input[type="email"],
        input[type="tel"],
        select,
        textarea {
            display: block;
            width: 100%;
            padding: 12px 16px;
            border: 1.5px solid #D1D5DB;
            border-radius: 10px;
            font-size: 15px;
            font-family: inherit;
            color: #111827;
            background: #F9FAFB;
            outline: none;
            transition: border-color 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
        }

        input[type="text"]:focus,
        input[type="password"]:focus,
        input[type="number"]:focus,
        input[type="email"]:focus,
        input[type="tel"]:focus,
        select:focus,
        textarea:focus {
            border-color: #064E3B;
            box-shadow: 0 0 0 3px rgba(6, 78, 59, 0.12);
            background: #ffffff;
        }

        /* Help text */
        .helptext,
        span.helptext,
        .help-block {
            display: block;
            font-size: 13px;
            color: #6B7280;
            margin-top: 6px;
            line-height: 1.5;
        }

        /* Error list */
        ul.errorlist {
            list-style: none;
            margin: 8px 0 0;
            padding: 0;
        }

        ul.errorlist li {
            font-size: 13px;
            color: #DC2626;
            padding: 4px 0;
        }

        ul.errorlist li::before {
            content: "⚠  ";
        }

        /* Paragraph / row spacing that django auto-renders */
        .tf-form p {
            margin-bottom: 20px;
        }

        /* Django table-style forms */
        .tf-form table {
            width: 100%;
            border-collapse: collapse;
        }

        .tf-form table tr {
            display: block;
            margin-bottom: 20px;
        }

        .tf-form table th,
        .tf-form table td {
            display: block;
            width: 100%;
            text-align: left;
            padding: 0;
        }

        .tf-form table th {
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 7px;
            padding-bottom: 4px;
        }

        /* ── Button row ─────────────────────────────────────────────────────── */
        /*
         * django-two-factor renders a mix of:
         *   <input type="submit" value="Next">
         *   <a href="...">Cancel</a>
         *   <button type="submit" name="wizard_goto_step" value="...">Back</button>
         *
         * We style all of them consistently.
         */

        /* Primary submit — "Next", "Enable", "Confirm" etc. */
        input[type="submit"][value]:not([value=""]) {
            display: inline-block;
            width: 100%;
            padding: 13px 24px;
            background: #064E3B;
            color: #ffffff;
            font-size: 15px;
            font-family: inherit;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            letter-spacing: 0.3px;
            margin-top: 8px;
            transition: background 0.2s, box-shadow 0.2s, transform 0.1s;
        }

        input[type="submit"][value]:not([value=""]):hover {
            background: #065F46;
            box-shadow: 0 5px 16px rgba(6, 78, 59, 0.30);
        }

        input[type="submit"][value]:not([value=""]):active {
            transform: scale(0.98);
        }

        /* Wizard "Back" step button */
        button[type="submit"][name="wizard_goto_step"] {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 10px 20px;
            background: transparent;
            color: #064E3B;
            font-size: 14px;
            font-family: inherit;
            font-weight: 600;
            border: 1.5px solid #064E3B;
            border-radius: 10px;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
        }

        button[type="submit"][name="wizard_goto_step"]:hover {
            background: #064E3B;
            color: #ffffff;
        }

        /* Cancel link — rendered as <a> by the library */
        .tf-form a,
        a.cancel-link {
            color: #064E3B;
            font-weight: 600;
            font-size: 14px;
            text-decoration: none;
            border-bottom: 1.5px solid transparent;
            transition: border-color 0.2s;
        }

        .tf-form a:hover,
        a.cancel-link:hover {
            border-bottom-color: #064E3B;
        }

        /* Button row wrapper (django renders these inside <p> or <ul li> tags) */
        .tf-form .submit-row,
        .tf-form p:last-of-type {
            display: flex;
            align-items: center;
            gap: 14px;
            flex-wrap: wrap;
            margin-top: 8px;
        }

        /* ── Divider ─────────────────────────────────────────────────────────── */
        hr.divider {
            border: none;
            border-top: 1px solid #E5E7EB;
            margin: 28px 0;
        }

        /* ── TOTP secret code block (shown on the generator step) ───────────── */
        .totp-secret {
            background: #F0FDF4;
            border: 1.5px solid #D1FAE5;
            border-radius: 10px;
            padding: 14px 18px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 15px;
            color: #064E3B;
            font-weight: 700;
            word-break: break-all;
            letter-spacing: 1.5px;
            margin: 12px 0 20px;
        }

        /* ── Card footer ─────────────────────────────────────────────────────── */
        .card-footer {
            border-top: 1px solid #E5E7EB;
            background: #F9FAFB;
            padding: 16px 44px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .card-footer .copyright {
            font-size: 12px;
            color: #9CA3AF;
        }

        .card-footer a {
            font-size: 13px;
            font-weight: 600;
            color: #064E3B;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .card-footer a:hover {
            text-decoration: underline;
        }

        /* ── Responsive ──────────────────────────────────────────────────────── */
        @media (max-width: 600px) {
            .card-body    { padding: 28px 24px; }
            .card-header  { padding: 28px 24px 24px; }
            .card-footer  { padding: 14px 24px; }
            .wizard-steps { padding: 14px 24px; }
            .step-connector { width: 20px; }
        }
    </style>

    {% block extra_head %}{% endblock %}
</head>

<body>

<div class="auth-card">

    <!-- ── Brand header ── -->
    <div class="card-header">
        <div class="brand-wrap">
            <div class="brand-icon">
                <!-- Shield icon — replace with your actual logo if desired -->
                <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path fill-rule="evenodd" d="M12 2l7 4v5c0 5.25-3.5 9.74-7 11C8.5 20.74 5 16.25 5 11V6l7-4z" clip-rule="evenodd"/>
                </svg>
            </div>
            <span class="brand-name">Material<em>Wear</em></span>
        </div>
        <h1>{% block page_title %}Two-Factor Authentication{% endblock %}</h1>
        <p class="subtext">Keeping your account secure</p>
    </div>

    <!-- ── Wizard steps (child templates fill this in) ── -->
    {% block wizard_steps %}{% endblock %}

    <!-- ── Card body ── -->
    <div class="card-body">

        <!-- Flash messages -->
        {% if messages %}
        <div class="messages">
            {% for message in messages %}
            <div class="message {{ message.tags }}">
                <span class="message-icon">
                    {% if message.tags == 'error' %}⚠
                    {% elif message.tags == 'success' %}✓
                    {% elif message.tags == 'warning' %}⚑
                    {% else %}ℹ{% endif %}
                </span>
                <span>{{ message }}</span>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- QR code (generator step renders this block) -->
        {% block qr_code %}{% endblock %}

        <!-- Step description / instructions -->
        {% block content_description %}{% endblock %}

        <!-- Main form content from child template -->
        <div class="tf-form">
            {% block content %}{% endblock %}
        </div>

    </div><!-- /card-body -->

    <!-- ── Footer ── -->
    <div class="card-footer">
        <span class="copyright">© {% now "Y" %} Material Wear</span>
        <a href="{% url 'two_factor:profile' %}">← Account Security</a>
    </div>

</div><!-- /auth-card -->

</body>
</html>