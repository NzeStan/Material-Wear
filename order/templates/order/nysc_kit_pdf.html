<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <style>
        body { font-family: sans-serif; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f5f5f5; }
        .summary { margin-top: 30px; }
        h1, h2 { color: #333; }
        .measurements { margin-top: 40px; }
    </style>
</head>
<body>
    <h1>NYSC Kit Orders Report {% if selected_state %}- {{ selected_state }}{% endif %}</h1>
    
    <table>
        <thead>
            <tr>
                <th>S/N</th>
                <th>Full Name</th>
                <th>State Code</th>
                <th>State</th>
                <th>Local Government</th>
                <th>Product Name</th>
                <th>Type</th>
                <th>Size</th>
                <th>Quantity</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
            <tr>
                <td>{{ order.sn }}</td>
                <td>{{ order.full_name }}</td>
                <td>{{ order.state_code }}</td>
                <td>{{ order.state }}</td>
                <td>{{ order.local_government }}</td>
                <td>{{ order.product_name }}</td>
                <td>{{ order.type }}</td>
                <td>{{ order.size }}</td>
                <td>{{ order.quantity }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% if measurements %}
    <div class="measurements">
        <h2>Khaki Measurements</h2>
        <table>
            <thead>
                <tr>
                    <th>S/N</th>
                    <th>Full Name</th>
                    <th>Chest</th>
                    <th>Shoulder</th>
                    <th>Sleeve Length</th>
                    <th>Sleeve Round</th>
                    <th>Top Length</th>
                    <th>Waist</th>
                    <th>Thigh</th>
                    <th>Knee</th>
                    <th>Ankle</th>
                    <th>Hips</th>
                    <th>Trouser Length</th>
                </tr>
            </thead>
            <tbody>
                {% for item in measurements %}
                <tr>
                    <td>{{ item.sn }}</td>
                    <td>{{ item.full_name }}</td>
                    <td>{{ item.measurements.chest }}</td>
                    <td>{{ item.measurements.shoulder }}</td>
                    <td>{{ item.measurements.sleeve_length }}</td>
                    <td>{{ item.measurements.sleeve_round }}</td>
                    <td>{{ item.measurements.top_length }}</td>
                    <td>{{ item.measurements.waist }}</td>
                    <td>{{ item.measurements.thigh }}</td>
                    <td>{{ item.measurements.knee }}</td>
                    <td>{{ item.measurements.ankle }}</td>
                    <td>{{ item.measurements.hips }}</td>
                    <td>{{ item.measurements.trouser_length }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}

    <div class="summary">
        <h2>Summary</h2>
        {% for type, data in summary.items %}
        <h3>{{ type|title }}</h3>
        <ul>
            <li>Total Quantity: {{ data.total_quantity }}</li>
            <h4>Size Breakdown:</h4>
            <ul>
                {% for size, count in data.sizes.items %}
                <li>{{ size }}: {{ count }}</li>
                {% endfor %}
            </ul>
        </ul>
        {% endfor %}
    </div>
</body>
</html>